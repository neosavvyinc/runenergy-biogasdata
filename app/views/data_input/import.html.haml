.data-input.import
  = render 'shared/dashboard_actions', :landfill_operators => @landfill_operators, :sites => @sites, :sections => @sections, :assets => @assets, :monitor_classes => @monitor_classes
  .content{'ng-controller' => 'controllers.DataInputImportController'}
    - if @error
      %label.error #{@error}
    - unless @readings.nil?
      %a.btn.btn-primary{'ng-click' => 'onCompleteImport()'} Complete Import
      %ns-serialize{'data' => @readings.try(:to_json).try(:html_safe), 'property' => 'data'}
    - else
      = form_tag data_input_import_path, multipart: true do
        .span3
          = label_tag(:column_definition_row, 'Column Name Row:')
          = text_field_tag(:column_definition_row, 1, 'ng-model' => 'columnNameRow')
          = label_tag(:first_data_row, 'First Data Row:')
          = text_field_tag(:first_data_row, 2, 'ng-model' => 'firstDataRow')
          = label_tag(:column_definition_row, 'Last Data Row (defaults to end):')
          = text_field_tag(:last_data_row)
        .span4
          = file_field(:files, :csv, 'ns-retrieve-element' =>'fileInput', 'ng-disabled' => 'requiredFieldsMissing')
        %input{name: 'authenticity_token', type: 'hidden', value: form_authenticity_token}
        = submit_tag 'Import', 'ng-disabled' => 'requiredFieldsMissing'
    = render 'shared/import_data_table', :angular_controller => 'controllers.PreviewCreate'