.data-input.import{'re-show-when-ready' => true, 'style' => 'display: none;'}
  = render 'shared/dashboard_actions', :landfill_operators => @landfill_operators, :sites => @sites, :sections => @sections, :assets => @assets, :monitor_classes => @monitor_classes,
    :operator => @operator, :site => @site, :monitor_class => @monitor_class, :section => @section, :asset => @asset, :locations_monitor_class => @locations_monitor_class, :monitor_points => @monitor_points, :locked => (@locked || false), :edit_allowed => false
  = render 'shared/create_monitor_point'
  .clearfix
  .content{'ng-controller' => 'controllers.DataInputImportController', 're-spinning-overlay' => 'loading'}
    %label.error.qa-main-error{'ng-bind' => 'error'}
    - unless @readings.nil?
      %div{'ng-show' => 'data.length'}
        %h4 Spreadsheet Preview & Assignment
        %a.btn.btn-primary.complete{'ng-click' => 'onCompleteImport()', 'ng-show' => 'data.length'} Complete Import
        %div{'ng-show' => '!readingMods.dateColumnName'}
          %h4.assign-date Assign Date For Readings
          %datepicker{'ng-model' => 'readingDate', 'date-format' => 'd/M/yyyy', 'disable-timepicker' => 'true'}
        .date-format{'ng-if' => 'readingMods.dateColumnName'}
          %h4.assign-date Date Format
          %input{'ng-model' => 'readingMods.dateFormat'}
          %a{:href => 'http://pubs.opengroup.org/onlinepubs/009695399/functions/strptime.html', :target => '_blank'} Documentation
        %ns-serialize{'data' => @readings.try(:to_json).try(:html_safe), 'property' => 'data'}
    - else
      = form_tag "{{getFormPostUrl('#{data_input_import_path}', newDataValues)}}", multipart: true, 'ng-submit' => 'onSubmit($event)' do
        .span3
          = label_tag(:column_definition_row, 'Column Name Row:')
          = text_field_tag(:column_definition_row, 1, 'ng-model' => 'columnNameRow')
          = label_tag(:first_data_row, 'First Data Row:')
          = text_field_tag(:first_data_row, 2, 'ng-model' => 'firstDataRow')
          = label_tag(:column_definition_row, 'Last Data Row (defaults to end):')
          = text_field_tag(:last_data_row)
        .span4
          = file_field(:files, :csv, 'ns-retrieve-element' =>'fileInput', 'ng-disabled' => 'requiredFieldsMissing')
        %input{name: 'authenticity_token', type: 'hidden', value: form_authenticity_token}
        = submit_tag 'Import', 'ng-disabled' => 'requiredFieldsMissing'
    %h4{'ng-show' => '!approvals.upperLimit && upperLimits.length'}  Upper Limits
    = render 'shared/limit_data_table', :angular_controller => 'controllers.UpperLimit', :monitor_points => @monitor_points
    %h4{'ng-show' => '!approvals.lowerLimit && lowerLimits.length'} Lower Limits
    = render 'shared/limit_data_table', :angular_controller => 'controllers.LowerLimit', :monitor_points => @monitor_points
    = render 'shared/import_data_table'