/*! neosavvy-javascript-core - v0.0.5 - 2013-12-11
* Copyright (c) 2013 Neosavvy, Inc.; Licensed  */
var Neosavvy=Neosavvy||{};Neosavvy.Core=Neosavvy.Core||{},Neosavvy.Core.Builders=Neosavvy.Core.Builders||{},Neosavvy.Core.Builders.CollectionBuilder=function(a){if(!a)throw"You must pass in a collection as the base upon which to build!";this.operations={},this.collection=a},Neosavvy.Core.Builders.CollectionBuilder.prototype={nest:function(a){if(_.isEmpty(a))throw"You must pass a valid propertyString to nest a collection.";return this.operations.nest=a,this},build:function(){if(_.keys(this.operations).length){var a=function(a,b){for(var c=b.split(".");c.length;){var d={};d[c.pop()]=a,a=d}return a};return _.map(this.collection,function(b){return this.operations.nest&&(b=a(b,this.operations.nest)),b},this)}return this.collection}};var Neosavvy=Neosavvy||{};Neosavvy.Core=Neosavvy.Core||{},Neosavvy.Core.Builders=Neosavvy.Core.Builders||{},Neosavvy.Core.Builders.RequestUrlBuilder=function(a){if(!a)throw"You must provide a base url for every request url built.";this.keyValues={},this.replacements={},this.baseUrl=a},Neosavvy.Core.Builders.RequestUrlBuilder.prototype={addParam:function(a,b){if("object"==typeof a){if(!Neosavvy.Core.Utils.MapUtils.keysDistinct(this.keyValues,a))throw"You have passed overlapping keys for object arguments.";this.keyValues=_.merge(this.keyValues,a)}else{if(!a||!b)throw"You must provide either a keyValue object, or a key value as arguments.";if(this.keyValues=this.keyValues||{},void 0!==this.keyValues[a])throw"You have attempted to overwrite an existing key value in the request url.";this.keyValues[a]=b}return this},paramReplace:function(a,b){if("object"==typeof a){if(!Neosavvy.Core.Utils.MapUtils.keysDistinct(this.replacements,a))throw"You have passed overlapping keys for object arguments.";this.replacements=_.merge(this.replacements,a)}else{if(!a||!b)throw"You must provide either a keyValue object, or a key value as arguments.";if(this.replacements=this.replacements||{},void 0!==this.replacements[a])throw"You have attempted to overwrite an existing key value in the request url.";this.replacements[a]=b}return this},build:function(){if(this.replacements)for(var a in this.replacements)this.baseUrl=this.baseUrl.replace(new RegExp(a,"g"),String(this.replacements[a]));if(this.keyValues){var b=0;for(var a in this.keyValues)this.baseUrl+=0===b?"?":"&",this.baseUrl+=a+"="+String(this.keyValues[a]),b++}return this.baseUrl}};var Neosavvy=Neosavvy||{};Neosavvy.Core=Neosavvy.Core||{},Neosavvy.Core.Builders=Neosavvy.Core.Builders||{},Neosavvy.Core.Builders.StringBuilder=function(a){if(!a)throw"Do not try to build a string with no input, it is pointless.";this.input=a,this.output=a},Neosavvy.Core.Builders.StringBuilder.prototype={camelToDash:function(){return this.output=this.output.replace(/\W+/g,"-").replace(/([a-z\d])([A-Z])/g,"$1-$2").toLowerCase(),this},constantToDash:function(){return this.output=this.output.replace(/_/g,"-").toLowerCase(),this},properCase:function(){return this.output=this.output.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()}),this},build:function(){return this.output}},function(a){"use strict";a.memoize||(a.memoize="object"==typeof JSON&&"function"==typeof JSON.stringify?function(a){var b=JSON.stringify,c={},d=function(){var d=b(arguments);return d in c?c[d]:c[d]=a.apply(this,arguments)};return d.__cache=function(){return c.remove||(c.remove=function(){var a=b(arguments);return delete c[a]}),c}.call(this),d}:function(a){return a})}(this),function(a,b){if(!b||!memoize)throw"Either Lodash or global memoize has not been loaded within this application. Please load these files before cached-lodash.js";a._cached=a._cached||{};for(var c in b)"memoize"!==c&&(a._cached[c]=memoize(b[c]))}(window,window._);var Neosavvy=Neosavvy||{};Neosavvy.Core=Neosavvy.Core||{},Neosavvy.Core.Utils=Neosavvy.Core.Utils||{},Neosavvy.Core.Builders=Neosavvy.Core.Builders||{};var Neosavvy=Neosavvy||{};Neosavvy.Core=Neosavvy.Core||{},Neosavvy.Core.Utils=Neosavvy.Core.Utils||{},Neosavvy.Core.Utils.CollectionUtils=function(){return{itemByProperty:function(a,b,c){if(a&&a.length&&c)for(var d=0;d<a.length;d++){var e=Neosavvy.Core.Utils.MapUtils.get(a[d],b);if(e===c)return a[d]}return null},updateByProperty:function(a,b,c){if(a&&a.length&&b&&b[c]&&c)for(var d=0;d<a.length;d++)if(void 0!=a[d]&&null!=a[d]&&a[d][c]===b[c]){a[d]=b;break}},removeByProperty:function(a,b,c){if(a&&a.length&&b&&b[c]&&c)for(var d=0;d<a.length;d++)if(void 0!=a[d]&&null!=a[d]&&a[d][c]===b[c]){a.splice(d,1);break}},uniqueMap:function(a,b){var c={};if(a&&a.length)for(var d=0;d<a.length;d++)c[String(Neosavvy.Core.Utils.MapUtils.get(a[d],b))]=a[d];return c},containMatchByProperty:function(a,b,c){if(a&&b&&a.length&&b.length)for(var d,e=b.map(function(a){return Neosavvy.Core.Utils.MapUtils.get(a,c)}),f=0;f<a.length;f++)if(d=Neosavvy.Core.Utils.MapUtils.get(a[f],c),void 0!==d&&-1!==e.indexOf(d))return!0;return!1},collectionContainsAllOtherItems:function(a,b,c){if(a&&a.length&&b&&b.length){for(var d,e=a.map(function(a){return Neosavvy.Core.Utils.MapUtils.get(a,c)}),f=0;f<b.length;f++)if(d="object"==typeof b[f]?Neosavvy.Core.Utils.MapUtils.get(b[f],c):void 0,void 0===d&&-1===e.indexOf(d))return!1;return!0}return!1},containsExclusively:function(a,b){if(a&&b){for(var c=0;c<a.length;c++)if(-1===b.indexOf(a[c]))return!1;for(var c=0;c<b.length;c++)if(-1===a.indexOf(b[c]))return!1;return!0}return!1}}}();var Neosavvy=Neosavvy||{};Neosavvy.Core=Neosavvy.Core||{},Neosavvy.Core.Utils=Neosavvy.Core.Utils||{},Neosavvy.Core.Utils.DomUtils=function(){return{getElementsByAttribute:function(a,b,c){for(var d=[],e=document.getElementsByTagName(a),f=0;f<e.length;f++)e[f].getAttribute(b)==c&&d.push(e[f]);return d}}}();var Neosavvy=Neosavvy||{};Neosavvy.Core=Neosavvy.Core||{},Neosavvy.Core.Utils=Neosavvy.Core.Utils||{},Neosavvy.Core.Utils.MapUtils=function(){return{get:function(a,b){if(a&&b)for(b=b.split(".");b.length&&a;)a=a[b.shift()];return a},highPerformanceGet:function(a,b){if(a&&b){if(b=b.split("."),b.length>10)throw"You cannot pass in a string of properties greater than 10";try{switch(b.length){case 1:return a[b[0]];case 2:return a[b[0]][b[1]];case 3:return a[b[0]][b[1]][b[2]];case 4:return a[b[0]][b[1]][b[2]][b[3]];case 5:return a[b[0]][b[1]][b[2]][b[3]][b[4]];case 6:return a[b[0]][b[1]][b[2]][b[3]][b[4]][b[5]];case 7:return a[b[0]][b[1]][b[2]][b[3]][b[4]][b[5]][b[6]];case 8:return a[b[0]][b[1]][b[2]][b[3]][b[4]][b[5]][b[6]][b[7]];case 9:return a[b[0]][b[1]][b[2]][b[3]][b[4]][b[5]][b[6]][b[7]][b[8]];case 10:return a[b[0]][b[1]][b[2]][b[3]][b[4]][b[5]][b[6]][b[7]][b[8]][b[9]]}}catch(c){return void 0}}return a},applyTo:function(a,b,c){if(a&&b){if(b=b.split("."),b.length>10)throw"You cannot pass in a string of properties greater than 10";switch(b.length){case 1:a[b[0]]=c;break;case 2:a[b[0]][b[1]]=c;break;case 3:a[b[0]][b[1]][b[2]]=c;break;case 4:a[b[0]][b[1]][b[2]][b[3]]=c;break;case 5:a[b[0]][b[1]][b[2]][b[3]][b[4]]=c;break;case 6:a[b[0]][b[1]][b[2]][b[3]][b[4]][b[5]]=c;break;case 7:a[b[0]][b[1]][b[2]][b[3]][b[4]][b[5]][b[6]]=c;break;case 8:a[b[0]][b[1]][b[2]][b[3]][b[4]][b[5]][b[6]][b[7]]=c;break;case 9:a[b[0]][b[1]][b[2]][b[3]][b[4]][b[5]][b[6]][b[7]][b[8]]=c;break;case 10:a[b[0]][b[1]][b[2]][b[3]][b[4]][b[5]][b[6]][b[7]][b[8]][b[9]]=c}}return a},keysDistinct:function(){if(arguments.length>1){for(var a=0,b=0;b<arguments.length;b++)a+=_.keys(arguments[b]).length;return _.keys(_.merge.apply(this,arguments)).length===a}return!0}}}();var Neosavvy=Neosavvy||{};Neosavvy.Core=Neosavvy.Core||{},Neosavvy.Core.Utils=Neosavvy.Core.Utils||{},Neosavvy.Core.Utils.NumberUtils=function(){return{asOrdinal:function(a){var b=["th","st","nd","rd"],c=Math.abs(a)%100;return a+(b[(c-20)%10]||b[c]||b[0])},roundUpIfFloat:function(a){var b=Math.abs(a);return b-parseInt(b)>0?parseInt(a)+(0>a?-1:1):a},leadingZeroes:function(a,b){if(void 0!=a&&null!=a){(void 0==b||null==b)&&(b=2);var c=String(a),d="-"==c.charAt(0);d&&(c=c.slice(1));var e=c.split(".");for(2==e.length&&(c=e[0]);c.length<b;)c="0"+c;return 2==e.length&&(c+="."+e[1]),d?"-"+c:c}return a}}}();var Neosavvy=Neosavvy||{};Neosavvy.Core=Neosavvy.Core||{},Neosavvy.Core.Utils=Neosavvy.Core.Utils||{},Neosavvy.Core.Utils.RegexUtils=function(){var a=/^\s*[\w\-\+_]+(\.[\w\-\+_]+)*\@[\w\-\+_]+\.[\w\-\+_]+(\.[\w\-\+_]+)*\s*$/;return{matchStringAndLeadup:function(a){if(!_.isEmpty(a)){a=String(a);for(var b="",c=0;c<a.length;)b+="^"+a.slice(0,c+1)+"$",c<a.length-1&&(b+="|"),c++;return new RegExp(b.replace(/([.?*+[\]\\(){}-])/g,"\\$1"),"i")}return void 0},isEmail:function(b){return void 0!==b&&null!==b?-1!=String(b).search(a):!1}}}();var Neosavvy=Neosavvy||{};Neosavvy.Core=Neosavvy.Core||{},Neosavvy.Core.Utils=Neosavvy.Core.Utils||{},Neosavvy.Core.Utils.SpecialUtils=function(){return{keepTrying:function(){function a(){if(arguments.length){if(0!==arguments.length%2)throw"Keep trying requires an even number of arguments. Even indices are functions and odd indices are arrays or empty arrays of their arguments!";try{return arguments[0].apply(this,arguments[1])}catch(b){return a.apply(this,Array.prototype.slice.call(arguments,2))}}return null}return a.apply(this,arguments)}}}();var Neosavvy=Neosavvy||{};Neosavvy.Core=Neosavvy.Core||{},Neosavvy.Core.Utils=Neosavvy.Core.Utils||{},Neosavvy.Core.Utils.StringUtils=function(){var a=/^\s*$/;return{isBlank:function(b){return void 0===b||null===b||a.test(b)}}}();var Neosavvy=Neosavvy||{};Neosavvy.Core=Neosavvy.Core||{},Neosavvy.Core.Utils=Neosavvy.Core.Utils||{},Neosavvy.Core.Utils.UrlUtils=function(){function a(a,b){if(!a)throw Error("Can not create a url with undefined URL param");this._parse(a),b&&this.getQueryString().parse(b)}function b(a){this._params={},a&&this.parse(a)}for(var c="abcdefghijklmnopqrstuvwxyz0123456789+-.",d={},e=0;e<c.length;e++)d[c.charAt(e)]=!0;return a.parse=function(b,c){return new a(b,c)},a.isValidProtocol=function(a){for(var b=0;b<a.length;b++)if(!d[a.charAt(b)])return!1;return!0},a.prototype={_parse:function(c){var d;if(d=c.indexOf("#"),-1!==d&&(d+1<c.length&&(this.hash=c.substring(d+1)),c=c.substring(0,d)),d=c.indexOf(":"),-1!==d){var e=c.substring(0,d).toLowerCase();if(a.isValidProtocol(e)){if(this.protocol=e,d++,d===c.length)return;c=c.substring(d)}}if("/"===c.charAt(0)&&"/"===c.charAt(1)){if(d=c.indexOf("/",2),-1===d)return c.length>2&&this._parseNetworkLocation(c.substring(2)),void 0;this._parseNetworkLocation(c.substring(2,d)),c=c.substring(d)}var f=this.protocol;f&&"http"!==f&&"https"!==f?this.path=c:(d=c.indexOf("?"),-1===d?this.path=c:(this.path=c.substring(0,d),d+1<c.length&&(this.queryString=new b(c.substring(d+1)))))},_parseNetworkLocation:function(a){var b=a.indexOf(":");-1===b?this.host=a:(this.host=a.substring(0,b),b<a.length-1&&(this.port=a.substring(b+1)))},setHost:function(a){this.host=a},getHost:function(){return this.host},setPath:function(a){this.path=a},getPath:function(){return this.path},getQueryString:function(){return this.queryString||(this.queryString=new b),this.queryString},setQueryString:function(a){this.queryString=a},toString:function(){var a=this.queryString?this.queryString.toString():null,b=[];return this.protocol&&(b.push(this.protocol),b.push("://")),void 0!==this.host&&b.push(this.host),void 0!==this.port&&(b.push(":"),b.push(this.port)),b.push(this.path),a&&(b.push("?"),b.push(a)),this.hash&&(b.push("#"),b.push(this.hash)),b.join("")},removeParameter:function(a){this.getQueryString().remove(a)},setParameter:function(a,b){this.getQueryString().set(a,b)},getParameter:function(a){return this.getQueryString().get(a)},getPort:function(){return void 0!==this.port&&null!==this.port?parseInt(this.port):"http"===this.protocol?80:"https"===this.protocol?443:void 0}},b.parse=function(a){return a?new b(a.toString()):new b},b.prototype={getParameters:function(){return this._params},parse:function(a){if("object"==typeof a)for(var b in a)a.hasOwnProperty(b)&&this.add(b,a[b]);else for(var c=a.split("&"),d=0;d<c.length;d++){var e=c[d];pos=e.indexOf("=");var f,g;-1==pos?(f=e,g=null):(f=e.substring(0,pos),g=decodeURIComponent(e.substring(pos+1))),""!=f&&this.add(f,g)}},remove:function(a){delete this._params[a]},set:function(a,b){void 0===b||null===b?this.remove(a):this._params[a]=b},add:function(a,b){var c=this._params[a];if(void 0!==c)if(c.constructor===Array){if(b.constructor===Array)for(var d=0;d<b.length;d++)c.push(b[d]);else c.push(b);b=c}else b=[c,b];this._params[a]=b},get:function(a){var b=this._params[a];return void 0===b?null:b},toString:function(){var a=[];for(var b in this._params)if(this._params.hasOwnProperty(b)){var c=this._params[b];if(void 0===c||null===c)a.push(b);else if(c.constructor===Array)for(var d=0;d<c.length;d++)a.push(b+"="+encodeURIComponent(c[d]));else a.push(b+"="+encodeURIComponent(c))}return a.join("&")}},{URL:a,QueryString:b,parse:function(){return this.URL.parse.apply(this,arguments)}}}();