/*! neosavvy-javascript-angular-core - v0.1.4 - 2013-12-16
* Copyright (c) 2013 Neosavvy, Inc.; Licensed  */
var Neosavvy=Neosavvy||{};Neosavvy.AngularCore=Neosavvy.AngularCore||{},Neosavvy.AngularCore.Analytics=angular.module("neosavvy.angularcore.analytics",[]),Neosavvy.AngularCore.Controllers=angular.module("neosavvy.angularcore.controllers",[]),Neosavvy.AngularCore.Directives=angular.module("neosavvy.angularcore.directives",[]),Neosavvy.AngularCore.Filters=angular.module("neosavvy.angularcore.filters",[]),Neosavvy.AngularCore.Services=angular.module("neosavvy.angularcore.services",[]),Neosavvy.AngularCore.Dependencies=["neosavvy.angularcore.analytics","neosavvy.angularcore.controllers","neosavvy.angularcore.directives","neosavvy.angularcore.filters","neosavvy.angularcore.services"],function(a,b){function c(){var a={delay:1e3},b=/{{\$scope\..*?}}/g,c=/({{\$scope\.|}})/g,d=/{{\$controller\..*?}}/g,f=/({{\$controller\.|}})/g,g=/{{arguments\[\d\]}}/g,h=/{{[^\s]+?#[^\s]+?}}/g,i=/\$scope\.[^=<>\s&\|\(\)\!\%\+\-\*\\]*/g,j=/\$controller\.[^=<>\s&\|\(\)\!\%\+\-\*\\]*/g,k=/[^=<>\s&\|\(\)\!\%\+\-\*\\]*?#[^=<>\s&\|\(\)\!\%\+\-\*\\]*/g;this.config=function(b){if(!b||"object"!=typeof b||!b.callBack)throw"nsAnalytics needs a config object with a callback defined as a single function or an array.";a=_.merge(a,b),a.baseOptions=b.baseOptions},this.$get=["$injector","$rootScope","nsControllers","$parse",function(l,m,n,o){function p(a){return _.isUndefined(a)?"undefined":_.isNull(a)?"null":_.isBoolean(a)||_.isNumber(parseInt(a))&&!_.isNaN(parseInt(a))?a:"'"+a+"'"}function q(a,b){return Neosavvy.Core.Utils.StringUtils.isBlank(b)?!0:(b=b.replace(i,function(b){return p(Neosavvy.Core.Utils.MapUtils.highPerformanceGet(a.scope,b.replace("$scope.","")))}).replace(j,function(b){return p(Neosavvy.Core.Utils.MapUtils.highPerformanceGet(a.instance,b.replace("$controller.","")))}).replace(k,function(a){var b=a.split("#");return p(Neosavvy.Core.Utils.MapUtils.highPerformanceGet(l.get(b[0]),b[1]))}),o(b)())}function r(e,i,j,k){var m=D[i].hashString;if(q(e,D[i].condition)){if(D[i].hasScopeVars&&(m=m.replace(b,function(a){return Neosavvy.Core.Utils.MapUtils.highPerformanceGet(e.scope,a.replace(c,""))})),D[i].hasControllerVars&&(m=m.replace(d,function(a){return Neosavvy.Core.Utils.MapUtils.highPerformanceGet(e.instance,a.replace(f,""))})),D[i].hasArgumentsVars&&(m=m.replace(g,function(a){return j[parseInt(a.match(/\d/)[0])]})),D[i].hasInjectedVars&&(m=m.replace(h,function(a){var b=a.replace(/{{|}}/g,"").split("#");return Neosavvy.Core.Utils.MapUtils.highPerformanceGet(l.get(b[0]),b[1])})),m=JSON.parse(m),a.callBack)if(a.baseOptions&&(m.options=_.merge(a.baseOptions,m.options)),_.isArray(a.callBack))for(var n=0;n<a.callBack.length;n++)a.callBack[n](m.name,m.options);else a.callBack(m.name,m.options);k&&k.push(JSON.stringify({name:m.name,options:m.options}))}}function s(a,b,c,d,e){0>=d?r(a,b,c,e):setTimeout(function(){r(a,b,c,e)},d)}function t(a){var b=uuid.v1(),c=JSON.stringify(a),d=c.match(h);return D[b]={hashString:c,hasScopeVars:-1!==c.indexOf("{{$scope."),hasControllerVars:-1!==c.indexOf("{{$controller"),hasArgumentsVars:-1!==c.indexOf("{arguments["),hasInjectedVars:d&&d.length,condition:a.condition},b}function u(a,b,c,d,e){var f=function(){b.apply(b,arguments),s(a,c,arguments,d,e)};return f.toString=function(){return b.toString()},f}function v(a,b,c,d,e){if(a&&c){var f=a[C[b]];if(f)for(var g in f)if(c[g]&&"function"==typeof f[g]&&"constructor"!==g){var h=t(c[g]);f[g]=u(a,f[g],h,d,e)}}}function w(a,b,c,d,e){if(a&&c){var f=a[C[b]];f&&f&&f.$$watchers&&f.$$watchers.length&&_.forEach(f.$$watchers,function(b){if(c[b.exp]){var f=t(c[b.exp]);b.fn=u(a,b.fn,f,d,e)}})}}function x(a,b,c,d,e){if(a&&c){var f=a[C[b]];if(f&&f.$$listeners)for(var g in f.$$listeners)if(c[g]&&f.$$listeners[g].length)for(var h=t(c[g]),i=0;i<f.$$listeners[g].length;i++)f.$$listeners[g][i]=u(a,f.$$listeners[g][i],h,d,e)}}function y(a,b,c,d,e,f){v(a,A,b,e,f),v(a,B,b,e,f),w(a,B,c,e,f),x(a,B,d,e,f)}function z(b,c,d,f,g,h){var i;try{i=n.get(b)}catch(j){}if(g=g||0===g?g:a.delay,e){if(E[b]&&E[b].length)for(var k=0;k<E[b].length;k++){var l=E[b][k];y(e,l.methods,l.watches,l.listeners,l.delay,l.log)}}else if(i&&i.length)for(var k=0;k<i.length;k++)y(i[k],c,d,f,g,h);(c||d||f)&&(E[b]=E[b]||[],E[b].push({methods:c,watches:d,listeners:f,delay:g,log:h}))}var A="$controller",B="$scope",C={$controller:"instance",$scope:"scope"},D={},E={};return e=null,z}]}function d(a){var b=/^(\S+)(\s+as\s+(\w+))?$/;return{scope:!1,priority:-200,require:"ngController",link:function(c,d,f,g){var h=f.ngController.match(b),i=h[1];e={scope:c,instance:g},a(i),e=null}}}var e;b.module("neosavvy.angularcore.analytics").provider("nsAnalytics",c),b.module("neosavvy.angularcore.analytics").directive("ngController",["nsAnalytics",d])}(window,window.angular),function(a,b){function c(){var a=/^(\S+)(\s+as\s+(\w+))?$/;return{scope:!1,priority:-100,require:"ngController",link:function(b,c,d,g){var h=d.ngController.match(a),i=h[1];e[i]=e[i]||[],e[i].push({id:d.id||void 0,name:i,scope:b,instance:g}),f=e[i][e[i].length-1]}}}function d(){return{get:function(a){if(Neosavvy.Core.Utils.StringUtils.isBlank(a))return e;if(e[a]&&e[a].length)return e[a];throw"No controllers have been instantiated with this name. Either you have a type or race condition."},getById:function(a,b){if(e[a]&&e[a].length){var c=Neosavvy.Core.Utils.CollectionUtils.itemByProperty(e[a],"id",b);if(c)return c;throw"A controller with that dom based ID does not exist, check your spelling or initialization."}throw"No controllers have been instantiated with this name. Either you have a type or race condition."},getByScope:function(a){if(a){for(var b,c=_.isString(a)?a:a.$id,d=0;d<_.values(e).length;d++){var f=_.values(e)[d];if(b=Neosavvy.Core.Utils.CollectionUtils.itemByProperty(f,"scope.$id",c))break}if(b)return b;throw"No controller instance was found for the passed in scope or hashKey."}throw"You have passed in an empty scope or $$hashKey for a scope."},getLast:function(){return f}}}var e={},f=null;b.module("neosavvy.angularcore.controllers").factory("nsControllers",d),b.module("neosavvy.angularcore.controllers").directive("ngController",["nsAnalytics",c]),b.module("neosavvy.angularcore.controllers").config(function(){e={}})}(window,window.angular),Neosavvy.AngularCore.Directives.directive("nsInlineHtml",["$compile",function(a){return{restrict:"E",template:"<div></div>",replace:!0,scope:!1,link:function(b,c,d){if(!d.hasOwnProperty("value"))throw"You must provide an html value on the scope in order to bind inline html!";var e=d.$observe("value",function(d){d&&(a(c.replaceWith(d))(b),e())})}}}]),Neosavvy.AngularCore.Directives.directive("nsModal",["nsModal",function(a){return{restrict:"E",transclude:"element",replace:!0,scope:!1,compile:function(b,c,d){return function(b,c,e){var f=b.$new();if("string"!=typeof e.open)throw"an open handler was not specified";b.$on("$routeChangeStart",function(){a.close()});var g=b[e.callback]||angular.noop;b[e.open]=function(){d(f,function(b){a.open(f,b,g)})},b[e.close]=function(){a.close()}}}}}]),Neosavvy.AngularCore.Directives.directive("nsStaticInclude",["$http","$templateCache","$compile",function(a,b,c){return{restrict:"E",template:"<div></div>",replace:!0,scope:!1,compile:function(d,e){if(_.isEmpty(e.src))throw"You must pass in a source to render a Neosavvy static include directive.";var f=e.waitFor,g=e.watchWaitFor,h=e.waitForRender,i=e.watchWaitForRender;return _.isEmpty(f)&&_.isEmpty(g)&&(a.get(e.src,{cache:b}),_.isEmpty(i)?_.isEmpty(h)||(f=h):g=i),function(d,e,h){var i,j=function(a){e.replaceWith(c(angular.element(a.data))(d))},k=function(){a.get(h.src,{cache:b}).then(j),i&&i()};_.isEmpty(g)?!_.isEmpty(f)&&parseFloat(f)>0?setTimeout(k,parseFloat(f)):k():i=d.$watch(g,function(a){angular.isDefined(a)&&k()})}}}}]),Neosavvy.AngularCore.Directives.directive("nsSerialize",["$injector",function(a){return{restrict:"EA",scope:!1,link:function(b,c,d){if(void 0===d.data)throw"You must provide a data attribute for the nsSerialize directive!";if(void 0===d.property)throw"nsSerialize requires a property to place the data into!";var e=JSON.parse(d.data),f=d.inject?a.get(d.inject):b,g=Neosavvy.Core.Utils.MapUtils.highPerformanceGet(f,d.property.replace(/\(.*\)/g,""));"function"==typeof g?g.call(g,e):Neosavvy.Core.Utils.MapUtils.applyTo(f,d.property,e),"false"!==d.clean&&"0"!==d.clean&&c.removeAttr("data")}}}]),Neosavvy.AngularCore.Directives.directive("nsEvent",["$rootScope",function(){return{restrict:"A",scope:!1,link:function(a,b,c){function d(a){return a.match(/.*?(?=\(|$)/i)[0]}function e(a,b){if(_.isUndefined(a[d(b)])){if(a.$parent)return e(a.$parent,b);throw"Your handler method has not been found in the scope chain, please add "+b+" to the scope chain!"}return a}function f(b){var c=e(a,g[1]);c.$event=b,c.$apply(function(){c[g[1]]()})}var g=c.nsEvent.replace(/ /g,"").split(","),h=_.isUndefined(c.nsEventHighPriority)?!1:!0;if(g.length<2)throw"Specify an event and handler in order to use the ns-event directive!";if(2===g.length)h?b.bindFirst(g[0],f):b.bind(g[0],f);else for(var i=2;i<g.length;i++){var j=$(b).find(g[i]);h?j.bindFirst(g[0],f):j.bind(g[0],f)}}}}]),Neosavvy.AngularCore.Directives.directive("nsModelOnBlur",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){"radio"!==c.type&&"checkbox"!==c.type&&(b.unbind("input").unbind("keydown").unbind("change"),b.bind("blur",function(){a.$apply(function(){d.$setViewValue(b.val())})}))}}}),Neosavvy.AngularCore.Directives.directive("nsRequiredIfShown",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.unshift(function(a){var c=!b.is(":visible")||!Neosavvy.Core.Utils.StringUtils.isBlank(a);return d.$setValidity("nsRequiredIfShown",c),c?a:void 0})}}}),Neosavvy.AngularCore.Directives.directive("nsZurbCheckbox",function(){return{restrict:"E",replace:!0,template:'<label for="{{id}}-checkbox" ng-click="_onClick()"><input type="checkbox" id="{{id}}-checkbox" style="display: none;"><span class="custom checkbox"></span><span ng-bind="label"></span></label>',scope:{label:"@",onClick:"&",value:"=ngModel"},link:function(a,b,c){var d=!1,e=b.find("span.checkbox");a.id=c.id||uuid.v1(),a.$watch("value",function(a){d||(a?e.hasClass("checked")||e.addClass("checked"):e.removeClass("checked")),d=!1}),a._onClick=function(){d=!0,a.value=!e.hasClass("checked"),a.onClick&&a.onClick({value:a.value})}}}}),Neosavvy.AngularCore.Filters.filter("nsCollectionFilterProperties",function(){return function(a,b,c){return a&&c?a.filter(function(a){return-1!==c.indexOf(Neosavvy.Core.Utils.MapUtils.get(a,b))}):a}}),Neosavvy.AngularCore.Filters.filter("nsCollectionFilterPropertyContains",function(){return function(a,b,c){return a&&c?a.filter(function(a){return-1!==String(Neosavvy.Core.Utils.MapUtils.get(a,b)).toLowerCase().indexOf(String(c).toLowerCase())}):a}}),Neosavvy.AngularCore.Filters.filter("nsCollectionFilterProperty",function(){return function(a,b,c){return a&&c?a.filter(function(a){return Neosavvy.Core.Utils.MapUtils.get(a,b)===c}):a}}),Neosavvy.AngularCore.Filters.filter("nsCollectionNumericExpression",["$parse",function(a){return function(b,c,d){return b&&b.length?c&&c.length?b.filter(function(b){for(var e=0;e<c.length;e++){var f=c[e],g=f.expression;/</.test(g)||/>/.test(g)||(g=g.replace(/=/g,"=="));var h=d?b[parseInt(f.index)][d]:b[parseInt(f.index)];if(g&&/\d/.test(g)&&!a(String(h)+g)())return!1}return!0}):b:[]}}]),Neosavvy.AngularCore.Filters.filter("nsCollectionPage",function(){return function(a,b,c){if(a&&a.length){if(void 0!==b&&c){var d=b*c;return a.slice(d,Math.min(d+c,a.length))}}else a=[];return a}}),Neosavvy.AngularCore.Filters.filter("nsLogicalIf",function(){return function(a,b,c){return a?b:c}}),Neosavvy.AngularCore.Filters.filter("nsNumericClamp",function(){return function(a,b,c){if(_.isNumber(a)){if(b=b||0===b?parseFloat(b):void 0,c=c||0===c?parseFloat(c):void 0,a=parseFloat(a),_.isNumber(c)&&_.isNumber(b)&&b>c)throw"You have created an impossible clamp with this filter.";(b||0===b)&&(a=Math.max(b,a)),(c||0===c)&&(a=Math.min(c,a))}return a}}),Neosavvy.AngularCore.Filters.filter("nsTextReplace",function(){return function(a){if(!_.isEmpty(a)&&arguments.length>1)for(var b=1;b<arguments.length;b++)a=a.replace(new RegExp(arguments[b],"g"),"");return a}}),Neosavvy.AngularCore.Filters.filter("nsTruncate",function(){return function(a,b){return!_.isEmpty(a)&&b<a.length&&(a=a.slice(0,b)+"..."),a}}),function(a){function b(b){return h?b.data("events"):a._data(b[0]).events}function c(a,c,d){var e=b(a),f=e[c];if(!h){var g=d?f.splice(f.delegateCount-1,1)[0]:f.pop();return f.splice(d?0:f.delegateCount||0,0,g),void 0}d?e.live.unshift(e.live.pop()):f.unshift(f.pop())}function d(b,d,e){var f=d.split(/\s+/);b.each(function(){for(var b=0;b<f.length;++b){var d=a.trim(f[b]).match(/[^\.]+/i)[0];c(a(this),d,e)}})}var e=a.fn.jquery.split("."),f=parseInt(e[0]),g=parseInt(e[1]),h=1>f||1==f&&7>g;a.fn.bindFirst=function(){var b=a.makeArray(arguments),c=b.shift();return c&&(a.fn.bind.apply(this,arguments),d(this,c)),this},a.fn.delegateFirst=function(){var b=a.makeArray(arguments),c=b[1];return c&&(b.splice(0,2),a.fn.delegate.apply(this,arguments),d(this,c,!0)),this},a.fn.liveFirst=function(){var b=a.makeArray(arguments);return b.unshift(this.selector),a.fn.delegateFirst.apply(a(document),b),this},h||(a.fn.onFirst=function(b,c){var e=a(this),f="string"==typeof c;if(a.fn.on.apply(e,arguments),"object"==typeof b)for(var g in b)b.hasOwnProperty(g)&&d(e,g,f);else"string"==typeof b&&d(e,b,f);return e})}(jQuery),Neosavvy.AngularCore.Services.factory("nsModal",["$compile","$document","$animate","$timeout",function(a,b,c,d){function e(b,c,e){var k;if(!b||"object"!=typeof b)throw"missing scope parameter";if(!c)throw"missing template parameter";if(i=e||void 0,g=a(angular.element('<div ng-click="close()" class="modal-backdrop" style="background:rgba(10,10,10, 0.6); position:fixed; top:0px;right:0px;left:0px;bottom:0px;"></div>'))(b),k=angular.element('<div class="modal-position"></div>'),"object"==typeof c)k.append(c);else{if("string"!=typeof c)throw"template parameter must be of type object or string";var l=a(angular.element("<ng-include src=\"'"+c+"' \"></ng-include>"))(b);k.append(l)}h=a(angular.element('<div class="modal-overlay" ng-class="modalOverlayClass"></div>'))(b),h.append(k),b.close=f,d(function(){b.$apply(function(){j.append(g),j.append(h)})},0)}function f(){h&&(c.leave(h,function(){g.remove()}),"function"==typeof i&&i())}var g,h,i,j=b.find("body");return{open:e,close:f}}]),Neosavvy.AngularCore.Services.factory("nsServiceExtensions",["$q","$http",function(a,b){function c(a){var b,c,d,e={};return a?(_.forEach(a.split("\n"),function(a){d=a.indexOf(":"),b=_.lowercase(_.trim(a.substr(0,d))),c=_.trim(a.substr(d+1)),b&&(e[b]?e[b]+=", "+c:e[b]=c)}),e):e}function d(a){if(a.cache&&"GET"===a.method){var b=a.cache.get(a.url);if(b&&b.length)return b}return void 0}function e(a,b,d,e){a.cache&&"GET"===a.method&&a.cache.put(a.url,[b,d,c(e)])}return{request:function(c,d,e){if(!c.method)throw"You must provide a method for each service request.";if(!c.url)throw"You must provide a url for each service request.";var f=a.defer();return b(c).success(function(a){f.resolve(a),d&&d(a)}).error(function(a){f.reject(a),e&&e(a)}),f.promise},xhr:function(b){if(!b.method)throw"You must provide a method for each service request.";if(!b.url)throw"You must provide a url for each service request.";var c=b.$q?a.defer():Q.defer(),f=d(b);if(f)c.resolve(f[1]);else{var g=new XMLHttpRequest;g.onreadystatechange=function(){if(4===g.readyState){var a=g.responseText;200===g.status?(e(b,g.status,a,g.getAllResponseHeaders()),b.transformResponse?a=b.transformResponse(a):"application/json"===g.getResponseHeader("Content-Type")&&(a=JSON.parse(a)),c.resolve(a,g.status,g.getAllResponseHeaders())):c.reject(a,g.status,g.getAllResponseHeaders())}},g.onerror=function(){c.reject(g,g.status,g.getAllResponseHeaders())};var h=b.data;h&&(b.transformRequest?h=b.transformRequest(h):_.isString(h)||(h=JSON.stringify(h))),g.withCredentials=b.cors||!1,g.open(b.method,b.url,!0),g.send(h)}return c.promise},jqRequest:function(b){if(!b.method)throw"You must provide a method for each service request.";if(!b.url)throw"You must provide a url for each service request.";var c=b.q?Q.defer():a.defer(),e=d(b);if(e)c.resolve(e[1]);else{var f={type:b.method,url:b.url};b.data&&(f.data=b.transformRequest?b.transformRequest(b.data):b.data),b.ajax&&(f=_.merge(f,b.ajax));var g=$.ajax(f);g.done(function(a){b.transformResponse&&(a=b.transformResponse(g.responseText||JSON.stringify(g.responseJSON))),c.resolve(a)}).fail(function(a){c.reject(a)})}return c.promise}}}]);